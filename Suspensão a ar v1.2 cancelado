-- air_suspension_presets.lua
-- Air Suspension com hotkeys + presets

util.require_natives(1681379138)
util.keep_running()

menu.my_root():divider("Air Suspension")

local current_height = 0.008
local step = 0.001
local min_height, max_height = 0.000, 0.020

local presets = {
    {name="Andar (0.004)", h=0.004},
    {name="Baixo (0.010)", h=0.010},
    {name="Extremo (0.016)", h=0.016},
}
local custom_preset = {name="Personalizado", h=0.008}

local function get_current_vehicle() local veh = entities.get_user_vehicle_as_handle() if veh ~= 0 then return veh end return nil end
local function apply_height(veh, h) if veh and veh ~= 0 then VEHICLE.SET_VEHICLE_SUSPENSION_HEIGHT(veh, h) end end

menu.register_hotkey(0x26, function() current_height = math.min(current_height + step, max_height); local v = get_current_vehicle(); if v then apply_height(v, current_height); util.toast("⬆️ Altura: " .. string.format("%.4f", current_height)) end end)
menu.register_hotkey(0x28, function() current_height = math.max(current_height - step, min_height); local v = get_current_vehicle(); if v then apply_height(v, current_height); util.toast("⬇️ Altura: " .. string.format("%.4f", current_height)) end end)
menu.register_hotkey(0x27, function() local v = get_current_vehicle(); if v then apply_height(v, current_height); util.toast("➡️ Altura aplicada: " .. string.format("%.4f", current_height)) end end)

menu.my_root():slider_float("Altura da Suspensão", 0, 200, 8, 1, function(val) current_height = val / 1000.0; local v = get_current_vehicle(); if v then apply_height(v, current_height); util.toast("Altura ajustada: " .. string.format("%.4f", current_height)) end end)

menu.my_root():action("Aplicar altura atual", {}, "", function() local v = get_current_vehicle(); if v then apply_height(v, current_height); util.toast("Altura fixa em: " .. string.format("%.4f", current_height)) end end)

local preset_menu = menu.my_root():list("Presets de Altura", {}, "")
for _, p in ipairs(presets) do preset_menu:action(p.name, {}, "", function() current_height = p.h; local v = get_current_vehicle(); if v then apply_height(v, current_height); util.toast("Preset aplicado: " .. p.name) end end) end

preset_menu:action("Aplicar Preset Personalizado", {}, "", function() local v = get_current_vehicle(); if v then apply_height(v, custom_preset.h); util.toast(string.format("Preset personalizado aplicado: %.4f", custom_preset.h)) end end)
preset_menu:action("Salvar Altura Atual como Preset", {}, "", function() custom_preset.h = current_height; util.toast(string.format("Preset personalizado salvo: %.4f", custom_preset.h)) end)

menu.my_root():toggle_loop("Manter altura aplicada", {}, "", function() local v = get_current_vehicle(); if v then apply_height(v, current_height) end end)
